<%- include('header') %>

<section class="container">
  <h2 class="mb-4">Submit a new iteration</h2>
  <ul>
<% for (var i = 0; i < prCommits.length; i++) {
     var nr = (i + 1) + '/' + prCommits.length;
     var subject = prCommits[i].subject;
     var url = 'https://github.com/' + prInfo.base.owner + '/' + prInfo.base.repo + '/pull/' + prInfo.number + '/commits/' + prCommits[i].sha;
     var hasFailedChecks = prCommits[i].failedChecks && prCommits[i].failedChecks.length;
     var style = hasFailedChecks ? 'color: red' : '';
%>
    <li style="<%= style %>">[<%= nr %>] <a href="<%= url %>" style="<%= style %>"><%= subject %></a>
      <% if (hasFailedChecks) { %>
          <% prCommits[i].failedChecks.forEach(function(check) { %>
            (âœ˜ <%= check %>)
          <% }); %>
      <% } %>
    </li>
<% } %>
  </ul>

  <% if (failedChecks.length) { %>
  <section class="alert alert-danger">
    <h4 class="alert-heading">One or more checks failed</h4>
    <ul class="pl-4 my-0">
      <% failedChecks.forEach(function(check) { %>
      <li><%= check %></li>
      <% }); %>
    </ul>
  </section>
  <% } else { %>

  <form action="" method="post">
    <input class="d-block mx-auto btn btn-primary btn-lg" type="submit" value="Submit new iteration">
  </form>
  <% } %>
</section>
